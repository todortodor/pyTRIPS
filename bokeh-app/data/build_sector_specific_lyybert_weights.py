#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Apr  8 11:57:25 2025

@author: slepot
"""

import pandas as pd

lyybert_map = pd.read_csv('ALP_IPC/ISIC_Rev4/ipc4_to_isic_rev4_2.txt', dtype={'isic_rev4_2': 'str'})

replace_agg_sectors = {
    '01':'01T02',
    '02':'01T02',
    '05':'05T06',
    '06':'05T06',
    '07':'07T08',
    '08':'07T08',
    '10':'10T12',
    '11':'10T12',
    '12':'10T12',
    '13':'13T15',
    '14':'13T15',
    '15':'13T15',
    '17':'17T18',
    '18':'17T18',
    '31':'31T33',
    '32':'31T33',
    '33':'31T33',
    '36':'36T39',
    '37':'36T39',
    '38':'36T39',
    '39':'36T39',
    '41':'41T43',
    '42':'41T43',
    '43':'41T43',
    '45':'45T47',
    '46':'45T47',
    '47':'45T47',
    '55':'55T56',
    '56':'55T56',
    '58':'58T60',
    '59':'58T60',
    '60':'58T60',
    '62':'62T63',
    '63':'62T63',
    '64':'64T66',
    '65':'64T66',
    '66':'64T66',
    '69':'69T75',
    '70':'69T75',
    '71':'69T75',
    '72':'69T75',
    '73':'69T75',
    '74':'69T75',
    '75':'69T75',
    '77':'77T82',
    '78':'77T82',
    '79':'77T82',
    '80':'77T82',
    '81':'77T82',
    '82':'77T82',
    '86':'86T88',
    '87':'86T88',
    '88':'86T88',
    '90':'90T93',
    '91':'90T93',
    '92':'90T93',
    '93':'90T93',
    '94':'94T96',
    '95':'94T96',
    '96':'94T96',
    '97':'97T98',
    '98':'97T98'
    }

lyybert_map['isic_rev4_2'] = lyybert_map['isic_rev4_2'].replace(replace_agg_sectors)

lyybert_map = lyybert_map.groupby(['ipc4','isic_rev4_2']).sum().reset_index()

print(lyybert_map)